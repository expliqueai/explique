# Environment variables

## Next.js environment variables

These environment variables affect the Next.js app. Variables starting with `NEXT_PUBLIC_` can be used from the client code.

For local development, these variables can be changed in the `.env.local` file at the root of the project.

For the deployments on Vercel, these are set as environment variables in the Vercel configuration.

For the deployments at EPFL, these are set as environment variables on GitLab (see also `prod.Dockerfile`, where the variables are passed to the Docker container).

| Variable                 | Description                                                                                                                                                                                                                                                                                                                       |
| ------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `BASE_URL`               | _See the Convex environment variable with the same name_                                                                                                                                                                                                                                                                          |
| `NEXT_PUBLIC_CONVEX_URL` | The URL of the Convex deployment used                                                                                                                                                                                                                                                                                             |
| `CONVEX_DEPLOY_KEY`      | Used in the GitLab/Vercel deployments where the Convex deployment is automatically updated as part of the continuous deployment (CD).                                                                                                                                                                                             |
| `COMPRESS_API_KEY`       | The images generated by DALL·E are quite large, and we don’t want to serve them directly to our users to save on bandwidth. To compress them, we use a Next.js API route (since it is not easy to install the `sharp` npm package on Convex). To safeguard this API against misuse, we use a hardcoded API key for this endpoint. |
| `SENTRY_AUTH_TOKEN`      | Auth token for [Sentry](https://sentry.io) (error monitoring)                                                                                                                                                                                                                                                                     |
| `IDENTIFIER_SALT`        | The salt used to create identifiers (see [identifiers.md])                                                                                                                                                                                                                                                                        |
| `JWT_KEY`                | The private key used to identify the Next.js server to the Convex deployment. Used to sign login messages passed to Convex (see [identifiers.md])                                                                                                                                                                                 |
| `ADMIN_API_PUBLIC_KEY`   | The public key matching `ADMIN_API_PRIVATE_KEY` in the Convex environment variables. Used to verify admin tokens generated by Convex (see [identifiers.md])                                                                                                                                                                       |

## Convex environment variables

These environment variables affect the Convex backend.

You can set them from the Convex dashboard ([see the Convex documentation](https://docs.convex.dev/production/environment-variables)).

| Variable                | Description                                                                                                                                   |
| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `OPENAI_API_KEY`        | An OpenAI API key (used for the AI-powered features)                                                                                          |
| `GOOGLE_CLIENT_ID`      | OAuth client ID from Google (used for Google SSO login)                                                                                       |
| `GOOGLE_CLIENT_SECRET`  | OAuth client secret from Google (used for Google SSO login)                                                                                   |
| `BASE_URL`              | The base URL of the website (e.g. `http://localhost:3000` or `https://cs250.epfl.ch`)                                                         |
| `ADMIN_API_PRIVATE_KEY` | The private key matching the public key in the `ADMIN_API_PUBLIC_KEY` environment variable in Next.js                                         |
| `JWT_PUBLIC_KEY`        | The public key matching the private key in the `JWT_KEY` environment variable in Next.js                                                      |
| `LUCIA_ENVIRONMENT`     | Must be set to `prod` on production environments                                                                                              |
| `AUTO_JOIN_COURSE`      | If set, it will make new users automatically join the first course (i.e. the first one that was created) when they log in for the first time. |
| `GOOGLE_HOSTED_DOMAIN`  | A Google workspace domain (e.g. `stanford.edu`). Will restrict the Google login to this workspace and use the workspace’s login UI.           |
